# name: test/sql/xml_array_support.test
# description: Test XML array support for read_xml functions (issue #9)
# group: [sql]

require webbed

# Test read_xml_objects with array of file patterns (like list_transform)
query I
SELECT count(*) FROM read_xml_objects(['test/xml/simple.xml']);
----
1

# Test read_xml_objects with array of multiple files
query I
SELECT count(*) >= 1 FROM read_xml_objects(['test/xml/simple.xml', 'test/xml/large_catalog.xml'], ignore_errors := true);
----
true

# Test read_xml with array of file patterns (like list_transform)
query I
SELECT count(*) >= 1 FROM read_xml(['test/xml/simple.xml'], ignore_errors := true);
----
true

# Test read_xml with array generated by list_transform (like in the issue)
query I
SELECT count(*) FROM read_xml(
    list_transform(
        [0, 1],
        n -> case when n = 0 then 'test/xml/simple.xml' else 'test/xml/nonexistent.xml' end
    ),
    ignore_errors := true
);
----
2


# Test empty array (should fail)
statement error
SELECT * FROM read_xml_objects([]::VARCHAR[]);
----
No files found

# Test array with NULL values (should fail)
statement error
SELECT * FROM read_xml_objects(['test/xml/simple.xml', NULL]);
----
cannot process NULL file patterns

